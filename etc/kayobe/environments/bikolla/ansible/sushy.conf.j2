{% macro storage(uuid, enum, drive_id) -%}
    "{{ uuid }}": [
        {
            "Id": "{{ enum }}",
            "Name": "Local Storage Controller",
            "StorageControllers": [
                {
                    "MemberId": "0",
                    "Name": "Contoso Integrated RAID",
                    "SpeedGbps": 12
                }
            ],
            "Drives": [
                "{{ drive_id }}"
            ]
        }
    ]
{%- endmacro %}

{% macro drive(uuid, enum, drive_id) -%}
    ("{{ uuid }}", "{{ enum }}"): [
        {
            "Id": "{{ drive_id }}",
            "Name": "Drive Sample",
            "CapacityBytes": 899527000000,
            "Protocol": "SAS"
        }
    ]
{%- endmacro %}

{% macro volume(uuid, enum, hostname) -%}
    ("{{ uuid }}", "{{ enum }}"): [ {
            "libvirtPoolName": "default",
            "libvirtVolName": "{{ hostname }}.qcow2",
            "Id": "{{ enum }}",
            "Name": "{{ hostname }}-volume",
            "VolumeType": "File",
            "CapacityBytes": 1073741824
        }
    ]
{%- endmacro %}

SUSHY_EMULATOR_STORAGE = {
{% for host in groups["sushy-libvirt"] %}
    {{ storage(host | to_uuid, 1, ('drive-'+host) | to_uuid) }}
{% endfor %}
}

SUSHY_EMULATOR_DRIVES = {
{% for host in groups["sushy-libvirt"] %}
    {{ drive(host | to_uuid, 1, ('drive-'+host) | to_uuid) }}
{% endfor %}
}

SUSHY_EMULATOR_VOLUMES = {
{% for host in groups["sushy-libvirt"] %}
    {{ volume(host | to_uuid, 1, host) }}
{% endfor %}
}
